---
import { Github, Mail, Linkedin } from "@lucide/astro";
---

<div class="flex flex-col items-center justify-center flex-1 px-4 md:px-0">
    <!-- Top section -->
    <div
        class="flex flex-col md:flex-row items-center text-center md:text-left"
    >
        <!-- Name + rotating title -->
        <div
            class="flex flex-col items-center w-fit rounded-md border-2 border-primary-light"
        >
            <span class="text-3xl md:text-4xl text-primary-darkest p-4 md:p-5 bg-primary-light">
                TITO SILVA
            </span>

            <button
                id="title"
                type="button"
                class="text-primary-light text-sm md:text-base p-2 md:p-3 cursor-pointer transition-opacity duration-300"
            >
                SOFTWARE DEVELOPER
            </button>
        </div>

        <!-- Intro text -->
        <div class="flex flex-col mt-6 md:mt-0 md:mx-5 max-w-xl">
            <span
                class="text-primary-light text-2xl md:text-4xl underline-offset-8"
            >
                Hello, nice to meet you.
            </span>

            <span class="text-2xl md:text-4xl my-3">
                Let's build something together.
            </span>

            <a href="/about-me" class="mt-2 inline-block">
                <span class="underline-offset-8 hover:text-primary-light">
                    <u>Discover more about my work</u> >>
                </span>
            </a>
        </div>
    </div>

    <!-- Socials -->
    <div class="flex flex-row my-10 md:my-16 gap-6 md:gap-5">
        <a
            class="text-4xl md:text-5xl hover:text-primary-light transition-colors"
            href="https://github.com/titosilva"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="GitHub profile"
        >
            <Github size="1lh" />
        </a>

        <a
            class="text-4xl md:text-5xl hover:text-primary-light transition-colors"
            href="https://www.linkedin.com/in/tito-silva-31265b195/"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="LinkedIn profile"
        >
            <Linkedin size="1lh" />
        </a>

        <!-- Email copy button -->
        <div class="relative group">
            <button
                id="email-btn"
                type="button"
                aria-label="Copy email address"
                class="text-4xl md:text-5xl hover:text-primary-light transition-colors"
                data-email="jt.mat@hotmail.com"
            >
                <Mail size="1lh" />
            </button>

            <!-- Tooltip -->
            <div
                id="email-tooltip"
                class="pointer-events-none
          absolute bottom-full left-1/2 mb-3
          -translate-x-1/2
          opacity-0 scale-95
          group-hover:opacity-100 group-hover:scale-100
          transition-all duration-200
          bg-primary-darkest
          border border-primary-light
          text-primary-light
          text-xs md:text-sm
          rounded-md
          px-3 py-2
          whitespace-nowrap
          max-w-[90vw]
          text-center"
            >
                <span id="email-tooltip-text">Click to copy email</span>

                <!-- arrow -->
                <span
                    class="absolute top-full left-1/2
            -translate-x-1/2
            w-0 h-0
            border-l-8 border-r-8 border-t-8
            border-l-transparent border-r-transparent
            border-t-primary-light"
                ></span>
            </div>
        </div>
    </div>
</div>

<!-- Rotating title logic -->
<script>
    const titles = [
        "SOFTWARE ENGINEER",
        "TECH LEAD",
        "BRASIL!",
        "FULLSTACK DEVELOPER",
        "PROBLEM SOLVER",
        "CRYPTOGRAPHY LOVER",
        "NOT AN AI",
        "MATH SUPERFAN",
        "FATHER OF A LITTLE BOY",
    ];

    const intervalMs = 2000;
    let currentIndex = 0;
    let timer: number | null = null;

    const element = document.getElementById("title");

    if (element) {
        const nextTitle = () => {
            element.classList.add("opacity-0");

            setTimeout(() => {
                currentIndex = (currentIndex + 1) % titles.length;
                element.textContent = titles[currentIndex];
                element.classList.remove("opacity-0");
            }, 300);
        };

        const start = () => {
            if (!timer) timer = setInterval(nextTitle, intervalMs);
        };

        const stop = () => {
            if (timer) clearInterval(timer);
            timer = null;
        };

        start();

        element.addEventListener("mouseenter", stop);
        element.addEventListener("mouseleave", start);
        element.addEventListener("click", nextTitle);
    }
</script>

<!-- Copy email logic -->
<script>
    const emailBtn = document.getElementById("email-btn");
    const tooltipText = document.getElementById("email-tooltip-text");

    if (emailBtn && tooltipText) {
        const email = emailBtn.dataset.email;

        emailBtn.addEventListener("click", async () => {
            try {
                await navigator.clipboard.writeText(email!);
                tooltipText.textContent = "Copied! âœ”";

                setTimeout(() => {
                    tooltipText.textContent = "Click to copy email";
                }, 2000);
            } catch {
                tooltipText.textContent = "Failed to copy ðŸ˜•";
            }
        });
    }
</script>
